{"is_source_file": true, "format": "Python", "description": "This module implements a Redis-based caching system with a focus on managing cache entries with proper time-to-live (TTL) strategies. It includes a custom JSON encoder and various methods for interacting with the Redis cache, including getting, setting, deleting, and checking entries and TTL.", "external_files": ["app/core/config", "app/db/base"], "external_methods": [], "published": ["cache", "invalidate_cache", "get_redis_cache"], "classes": [{"name": "CustomJSONEncoder", "description": "Custom JSON encoder for handling complex types including Decimal, SQLAlchemy models, Enum, and Pydantic models."}, {"name": "RedisCache", "description": "A singleton class that manages Redis connections and provides methods for caching data with TTL management and cache invalidation."}], "methods": [{"name": "None initialize(self)", "description": "Initializes the Redis connection pool. It should be called during application startup.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "None close(self)", "description": "Closes the Redis connection pool. It should be called during application shutdown.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "Optional[Any] get(self, key: str)", "description": "Gets a value from the cache using the specified key.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "bool set( self, key: str, value: Any, expire: Optional[int] = None )", "description": "Sets a value in the cache with an optional expiration time.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "bool delete(self, key: str)", "description": "Deletes a value from the cache using the specified key.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "int delete_pattern(self, pattern: str)", "description": "Deletes all cache keys matching a given pattern.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "bool exists(self, key: str)", "description": "Checks if a key exists in the cache.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "int ttl(self, key: str)", "description": "Gets the remaining time to live for a key.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "bool set_ttl(self, key: str, expire: int)", "description": "Sets the expiration time for a specified key.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "bool clear_all(self)", "description": "Clears all cache entries.", "scope": "RedisCache", "scopeKind": "class"}, {"name": "Callable cache( expire: Optional[int] = None, prefix: Optional[str] = None, include_query_params: bool = True, include_path_params: bool = True, )", "description": "Decorator for caching API endpoint responses.", "scope": "", "scopeKind": ""}, {"name": "Callable invalidate_cache(pattern: str)", "description": "Decorator for invalidating cache after a function call.", "scope": "", "scopeKind": ""}, {"name": "RedisCache get_redis_cache()", "description": "Dependency for getting the Redis cache instance.", "scope": "", "scopeKind": ""}, {"name": "\"RedisCache\" __new__(cls)", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "Any _deserialize(self, value: str)", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "str _serialize(self, value: Any)", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "redis.Redis client(self)", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "Callable decorator(func: Callable)", "scope": "invalidate_cache", "scopeKind": "function", "description": "unavailable"}, {"name": "Any default(self, obj: Any)", "scope": "CustomJSONEncoder", "scopeKind": "class", "description": "unavailable"}, {"name": "str generate_cache_key( prefix: str, *args: CacheKeyType, **kwargs: CacheKeyType )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Any wrapper(*args: Any, **kwargs: Any)", "scope": "invalidate_cache.decorator", "scopeKind": "function", "description": "unavailable"}], "calls": ["redis.Redis.get", "redis.Redis.set", "redis.Redis.delete", "redis.Redis.keys", "redis.Redis.exists", "redis.Redis.ttl", "redis.Redis.expire", "redis.Redis.flushdb"], "search-terms": ["RedisCache", "CustomJSONEncoder", "cache", "invalidate_cache"], "state": 2, "file_id": 28, "knowledge_revision": 227, "git_revision": "a3d8193ce482c5ecc46bda2fc9a7157a6465c73d", "revision_history": [{"63": ""}, {"176": "3ca38c1a5bb82a63be25191740c83663bd590a04"}, {"177": "3ca38c1a5bb82a63be25191740c83663bd590a04"}, {"219": "fd885f2f5e005f62e2f1b99e0a8fee305af8a952"}, {"220": "fd885f2f5e005f62e2f1b99e0a8fee305af8a952"}, {"221": "fd885f2f5e005f62e2f1b99e0a8fee305af8a952"}, {"222": "fd885f2f5e005f62e2f1b99e0a8fee305af8a952"}, {"227": "a3d8193ce482c5ecc46bda2fc9a7157a6465c73d"}], "ctags": [{"_type": "tag", "name": "CacheKey", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^CacheKey = str$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "CacheKeyType", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^CacheKeyType = Union[str, int, float, bool, Tuple, List, Dict, BaseModel, Enum, Base, None]$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "CacheValue", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^CacheValue = Union[str, bytes, int, float, bool, Dict[str, Any], List[Any], None]$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "CustomJSONEncoder", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^class CustomJSONEncoder(json.JSONEncoder):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "RedisCache", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^class RedisCache:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "T", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^T = TypeVar(\"T\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "__new__", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def __new__(cls) -> \"RedisCache\":$/", "language": "Python", "typeref": "typename:\"RedisCache\"", "kind": "member", "signature": "(cls)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "_deserialize", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def _deserialize(self, value: str) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "member", "signature": "(self, value: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "_initialized", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    _initialized: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "_instance", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    _instance: Optional[\"RedisCache\"] = None$/", "language": "Python", "typeref": "typename:Optional[\"RedisCache\"]", "kind": "variable", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "_redis_client", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    _redis_client: Optional[redis.Redis] = None$/", "language": "Python", "typeref": "typename:Optional[redis.Redis]", "kind": "variable", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "_serialize", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def _serialize(self, value: Any) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self, value: Any)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "cache", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^def cache($/", "language": "Python", "typeref": "typename:Callable", "kind": "function", "signature": "( expire: Optional[int] = None, prefix: Optional[str] = None, include_query_params: bool = True, include_path_params: bool = True, )"}, {"_type": "tag", "name": "clear_all", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def clear_all(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "client", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def client(self) -> redis.Redis:$/", "language": "Python", "typeref": "typename:redis.Redis", "kind": "member", "signature": "(self)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "close", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def close(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def decorator(func: Callable) -> Callable:$/", "file": true, "language": "Python", "typeref": "typename:Callable", "kind": "function", "signature": "(func: Callable)", "scope": "cache", "scopeKind": "function"}, {"_type": "tag", "name": "decorator", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def decorator(func: Callable) -> Callable:$/", "file": true, "language": "Python", "typeref": "typename:Callable", "kind": "function", "signature": "(func: Callable)", "scope": "invalidate_cache", "scopeKind": "function"}, {"_type": "tag", "name": "default", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    def default(self, obj: Any) -> Any:$/", "language": "Python", "typeref": "typename:Any", "kind": "member", "signature": "(self, obj: Any)", "scope": "CustomJSONEncoder", "scopeKind": "class"}, {"_type": "tag", "name": "delete", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def delete(self, key: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, key: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "delete_pattern", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def delete_pattern(self, pattern: str) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self, pattern: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "exists", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def exists(self, key: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, key: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "generate_cache_key", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^def generate_cache_key($/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "( prefix: str, *args: CacheKeyType, **kwargs: CacheKeyType )"}, {"_type": "tag", "name": "get", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def get(self, key: str) -> Optional[Any]:$/", "language": "Python", "typeref": "typename:Optional[Any]", "kind": "member", "signature": "(self, key: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "get_redis_cache", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^async def get_redis_cache() -> RedisCache:$/", "language": "Python", "typeref": "typename:RedisCache", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "initialize", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def initialize(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "invalidate_cache", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^def invalidate_cache(pattern: str) -> Callable:$/", "language": "Python", "typeref": "typename:Callable", "kind": "function", "signature": "(pattern: str)"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^logger = logging.getLogger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "redis", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^import redis.asyncio as redis$/", "language": "Python", "kind": "namespace", "nameref": "module:redis.asyncio"}, {"_type": "tag", "name": "redis_cache", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^redis_cache = RedisCache()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "set", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def set($/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "( self, key: str, value: Any, expire: Optional[int] = None )", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "set_ttl", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def set_ttl(self, key: str, expire: int) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, key: str, expire: int)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "ttl", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^    async def ttl(self, key: str) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self, key: str)", "scope": "RedisCache", "scopeKind": "class"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^        async def wrapper(*args: Any, **kwargs: Any) -> Any:$/", "file": true, "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(*args: Any, **kwargs: Any)", "scope": "cache.decorator", "scopeKind": "function"}, {"_type": "tag", "name": "wrapper", "path": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "pattern": "/^        async def wrapper(*args: Any, **kwargs: Any) -> Any:$/", "file": true, "language": "Python", "typeref": "typename:Any", "kind": "function", "signature": "(*args: Any, **kwargs: Any)", "scope": "invalidate_cache.decorator", "scopeKind": "function"}], "filename": "/home/kavia/workspace/API-Performance-Optimization-L.0.8/app/core/cache.py", "hash": "fff0bcaa2ec64c3435aeda684b22f076", "format-version": 4, "code-base-name": "default", "fields": [{"name": "CacheKey = str", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "CacheKeyType = Union[str, int, float, bool, Tuple, List, Dict, BaseModel, Enum, Base, None]", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "CacheValue = Union[str, bytes, int, float, bool, Dict[str, Any], List[Any], None]", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "T = TypeVar(\"T\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "bool _initialized", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[\"RedisCache\"] _instance", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[redis.Redis] _redis_client", "scope": "RedisCache", "scopeKind": "class", "description": "unavailable"}, {"name": "logger = logging.getLogger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "redis_cache = RedisCache()", "scope": "", "scopeKind": "", "description": "unavailable"}]}